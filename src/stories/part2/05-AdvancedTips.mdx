import { Meta } from "@storybook/addon-docs/blocks";

<Meta title="2부: Claude Code Agent Team/05. 고급 팁 & 트러블슈팅" />

# 고급 팁 & 트러블슈팅

이 장에서는 Agent Team 환경을 더 효율적으로 운영하기 위한 고급 기법과,
실전에서 자주 마주치는 문제의 해결법을 다룹니다.

---

## 5.1 tmux 스크립트로 Agent Team 환경 자동 구성

매번 tmux 레이아웃을 수동으로 설정하는 것은 비효율적입니다.
프로젝트별 자동 구성 스크립트를 작성하면 빠르게 환경을 준비할 수 있습니다.

### 범용 Agent Team 시작 스크립트

```bash
#!/bin/bash
# agent-team-setup.sh
# 사용법: ./agent-team-setup.sh [프로젝트경로] [세션이름] [에이전트수]

PROJECT_DIR="${1:-.}"
SESSION_NAME="${2:-agent-team}"
NUM_AGENTS="${3:-3}"

# 기존 세션 확인
if tmux has-session -t $SESSION_NAME 2>/dev/null; then
  echo "세션 '$SESSION_NAME'이 이미 존재합니다."
  read -p "접속하시겠습니까? (y/n): " choice
  if [ "$choice" = "y" ]; then
    tmux attach -t $SESSION_NAME
    exit 0
  else
    exit 1
  fi
fi

# 새 세션 생성 - Lead 윈도우
tmux new-session -d -s $SESSION_NAME -n "lead" -c "$PROJECT_DIR"
tmux send-keys -t $SESSION_NAME:lead "claude" C-m

# 에이전트 윈도우 생성
for i in $(seq 1 $NUM_AGENTS); do
  tmux new-window -t $SESSION_NAME -n "agent-$i" -c "$PROJECT_DIR"
done

# 모니터링 윈도우 생성
tmux new-window -t $SESSION_NAME -n "monitor" -c "$PROJECT_DIR"
tmux split-window -h -t $SESSION_NAME:monitor -c "$PROJECT_DIR"
tmux split-window -v -t $SESSION_NAME:monitor.1 -c "$PROJECT_DIR"

# 모니터링 명령어
tmux send-keys -t $SESSION_NAME:monitor.0 \
  "watch -n 10 'git log --oneline -15'" C-m
tmux send-keys -t $SESSION_NAME:monitor.1 \
  "htop -t" C-m
tmux send-keys -t $SESSION_NAME:monitor.2 \
  "watch -n 5 'df -h . && echo \"---\" && free -h'" C-m

# Lead 윈도우로 이동 후 접속
tmux select-window -t $SESSION_NAME:lead
tmux attach -t $SESSION_NAME
```

### 셸 Alias로 빠른 환경 구성

`~/.bashrc` 또는 `~/.zshrc`에 다음 alias를 추가합니다:

```bash
# Agent Team 관련 alias
alias agent-start='bash ~/scripts/agent-team-setup.sh'
alias agent-attach='tmux attach -t agent-team'
alias agent-ls='tmux ls'
alias agent-kill='tmux kill-session -t agent-team'

# 프로젝트별 빠른 시작
alias agent-web='bash ~/scripts/agent-team-setup.sh ~/projects/web-app web-dev 3'
alias agent-api='bash ~/scripts/agent-team-setup.sh ~/projects/api api-dev 2'

# 에이전트 로그 캡처
alias agent-logs='bash ~/scripts/capture-agent-logs.sh'
```

사용 예:

```bash
# Agent Team 빠르게 시작
agent-start ~/my-project my-project 4

# 기존 세션에 접속
agent-attach

# 세션 목록 확인
agent-ls
```

### 프로젝트별 .tmux 설정 파일

프로젝트 디렉토리에 `.tmux-agent` 파일을 만들어 프로젝트별 설정을 관리할 수 있습니다.

```bash
# .tmux-agent (프로젝트 루트에 배치)
SESSION_NAME="my-project"
NUM_AGENTS=3
MONITOR_COMMANDS=(
  "npm test -- --watch"
  "npx tsc --watch --noEmit"
  "watch -n 5 'git status -s'"
)
```

```bash
#!/bin/bash
# load-tmux-agent.sh - .tmux-agent 파일을 읽어 환경 구성
CONFIG=".tmux-agent"

if [ -f "$CONFIG" ]; then
  source "$CONFIG"
  echo "프로젝트 설정 로드: $SESSION_NAME (에이전트 $NUM_AGENTS개)"
  bash ~/scripts/agent-team-setup.sh "$(pwd)" "$SESSION_NAME" "$NUM_AGENTS"
else
  echo ".tmux-agent 파일이 없습니다. 기본 설정으로 시작합니다."
  bash ~/scripts/agent-team-setup.sh
fi
```

---

## 5.2 에이전트 모니터링 대시보드 구성

### tmux 상태바 커스터마이징

tmux 상태바에 시스템 리소스 정보를 표시하면 에이전트의 리소스 사용량을 상시 확인할 수 있습니다.

```bash
# ~/.tmux.conf에 추가

# 상태바 갱신 간격 (초)
set -g status-interval 5

# 상태바 오른쪽: CPU, 메모리, 시간
set -g status-right-length 60
set -g status-right '#[fg=green]CPU:#(top -bn1 | grep "Cpu(s)" | awk "{print \$2}")%% #[fg=yellow]MEM:#(free | grep Mem | awk "{printf \"%.0f\", \$3/\$2*100}")%% #[fg=white]%H:%M'

# 상태바 왼쪽: 세션 이름
set -g status-left '[#S] '

# 활성 윈도우 강조
set -g window-status-current-style 'fg=white,bg=blue,bold'
```

### 멀티 pane 대시보드 레이아웃

전용 모니터링 대시보드를 구성하여 Agent Team의 전반적인 상태를 한눈에 파악합니다.

```bash
#!/bin/bash
# create-dashboard.sh - 모니터링 전용 윈도우 생성
SESSION="${1:-agent-team}"

tmux new-window -t $SESSION -n "dashboard"

# 6-pane 대시보드 구성
tmux split-window -h -t $SESSION:dashboard
tmux split-window -v -t $SESSION:dashboard.0
tmux split-window -v -t $SESSION:dashboard.2
tmux split-window -v -t $SESSION:dashboard.1
tmux split-window -v -t $SESSION:dashboard.4

# 각 pane에 모니터링 명령어 설정
tmux send-keys -t $SESSION:dashboard.0 \
  "watch -n 5 'echo \"=== Git Status ===\"; git status -s'" C-m
tmux send-keys -t $SESSION:dashboard.1 \
  "watch -n 10 'echo \"=== Recent Commits ===\"; git log --oneline -10'" C-m
tmux send-keys -t $SESSION:dashboard.2 \
  "watch -n 5 'echo \"=== Modified Files ===\"; git diff --name-only'" C-m
tmux send-keys -t $SESSION:dashboard.3 \
  "htop -t" C-m
tmux send-keys -t $SESSION:dashboard.4 \
  "watch -n 10 'echo \"=== Disk ===\"; df -h .; echo; echo \"=== Memory ===\"; free -h'" C-m
tmux send-keys -t $SESSION:dashboard.5 \
  "watch -n 5 'echo \"=== File Counts ===\"; echo \"JS: \$(find src -name \"*.js\" 2>/dev/null | wc -l)\"; echo \"TS: \$(find src -name \"*.ts\" 2>/dev/null | wc -l)\"'" C-m
```

<div style={{ border: '2px solid #4a9eff', borderRadius: '8px', overflow: 'hidden', margin: '20px 0', fontFamily: 'monospace', fontSize: '13px', maxWidth: '700px' }}>
  <div style={{ padding: '6px 12px', background: '#0d1117', color: '#4a9eff', fontWeight: 'bold', fontSize: '12px', borderBottom: '2px solid #4a9eff' }}>
    Window: dashboard
  </div>
  <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gridTemplateRows: '1fr 1fr 1fr' }}>
    <div style={{ padding: '12px', background: '#1a1a2e', color: '#e0e0e0', borderRight: '2px solid #4a9eff', borderBottom: '2px solid #4a9eff' }}>
      <div style={{ color: '#4a9eff', fontWeight: 'bold', marginBottom: '6px' }}>Git Status</div>
      <div><span style={{ color: '#ff9800' }}>M</span> src/api.ts</div>
      <div><span style={{ color: '#00e676' }}>A</span> src/types/tag.ts</div>
      <div><span style={{ color: '#ff9800' }}>M</span> tests/api.test</div>
    </div>
    <div style={{ padding: '12px', background: '#1a1a2e', color: '#e0e0e0', borderBottom: '2px solid #4a9eff' }}>
      <div style={{ color: '#4a9eff', fontWeight: 'bold', marginBottom: '6px' }}>Recent Commits</div>
      <div style={{ color: '#aaa' }}>a1b2c3 feat: tag</div>
      <div style={{ color: '#aaa' }}>d4e5f6 fix: auth</div>
      <div style={{ color: '#aaa' }}>g7h8i9 refactor</div>
    </div>
    <div style={{ padding: '12px', background: '#1a1a2e', color: '#e0e0e0', borderRight: '2px solid #4a9eff', borderBottom: '2px solid #4a9eff' }}>
      <div style={{ color: '#4a9eff', fontWeight: 'bold', marginBottom: '6px' }}>Modified Files</div>
      <div style={{ color: '#aaa' }}>src/api.ts</div>
      <div style={{ color: '#aaa' }}>src/types/tag.ts</div>
      <div style={{ color: '#aaa' }}>tests/api.test.ts</div>
    </div>
    <div style={{ padding: '12px', background: '#1a1a2e', color: '#e0e0e0', borderBottom: '2px solid #4a9eff' }}>
      <div style={{ color: '#4a9eff', fontWeight: 'bold', marginBottom: '6px' }}>System Resources</div>
      <div>
        <span style={{ color: '#aaa' }}>CPU: </span>
        <span style={{ display: 'inline-block', width: '80px', height: '10px', background: '#333', borderRadius: '5px', overflow: 'hidden', verticalAlign: 'middle' }}>
          <span style={{ display: 'block', width: '48%', height: '100%', background: '#ff9800', borderRadius: '5px' }}></span>
        </span>
        <span style={{ color: '#ff9800', marginLeft: '4px' }}>48%</span>
      </div>
      <div>
        <span style={{ color: '#aaa' }}>MEM: </span>
        <span style={{ display: 'inline-block', width: '80px', height: '10px', background: '#333', borderRadius: '5px', overflow: 'hidden', verticalAlign: 'middle' }}>
          <span style={{ display: 'block', width: '72%', height: '100%', background: '#ff5252', borderRadius: '5px' }}></span>
        </span>
        <span style={{ color: '#ff5252', marginLeft: '4px' }}>72%</span>
      </div>
    </div>
    <div style={{ padding: '12px', background: '#1a1a2e', color: '#e0e0e0', borderRight: '2px solid #4a9eff' }}>
      <div style={{ color: '#4a9eff', fontWeight: 'bold', marginBottom: '6px' }}>Disk & Memory</div>
      <div style={{ color: '#aaa' }}>/dev/sda1 45G/100G</div>
      <div style={{ color: '#aaa' }}>Mem: 8.2G/16G</div>
    </div>
    <div style={{ padding: '12px', background: '#1a1a2e', color: '#e0e0e0' }}>
      <div style={{ color: '#4a9eff', fontWeight: 'bold', marginBottom: '6px' }}>File Counts</div>
      <div style={{ color: '#aaa' }}>JS: 32</div>
      <div style={{ color: '#aaa' }}>TS: 18</div>
    </div>
  </div>
</div>

### 알림 설정 (에이전트 작업 완료 시)

특정 윈도우에서 활동이 발생하면 알림을 받을 수 있습니다.

```bash
# 특정 윈도우의 활동 모니터링 활성화
tmux set-window-option -t agent-team:agent-1 monitor-activity on
tmux set-window-option -t agent-team:agent-2 monitor-activity on

# 시각적 알림 활성화
tmux set-option -g visual-activity on

# 벨 소리 알림
tmux set-option -g visual-bell on

# ~/.tmux.conf에 기본값으로 설정
# set-window-option -g monitor-activity on
# set-option -g visual-activity on
```

이 설정을 적용하면, 현재 보고 있지 않은 윈도우에서 에이전트가 출력을 생성할 때
상태바에 해당 윈도우가 강조 표시됩니다.

---

## 5.3 로그 관리 및 출력 캡처

### capture-pane으로 에이전트 출력 저장

```bash
# 현재 pane의 전체 스크롤백 버퍼를 파일로 저장
tmux capture-pane -p -S - > agent-output.log

# 특정 세션:윈도우의 출력 저장
tmux capture-pane -t agent-team:lead -p -S - > lead-output.log

# 모든 윈도우의 출력을 한번에 저장하는 스크립트
#!/bin/bash
SESSION="agent-team"
TIMESTAMP=$(date +%Y%m%d_%H%M%S)
LOG_DIR="logs/$TIMESTAMP"
mkdir -p $LOG_DIR

for window in $(tmux list-windows -t $SESSION -F '#W'); do
  for pane in $(tmux list-panes -t "$SESSION:$window" -F '#P'); do
    tmux capture-pane -t "$SESSION:$window.$pane" -p -S - \
      > "$LOG_DIR/${window}_pane${pane}.log"
  done
done
echo "로그 저장 완료: $LOG_DIR"
```

### pipe-pane으로 실시간 로깅

`pipe-pane`을 사용하면 pane의 출력을 실시간으로 파일에 기록합니다.

```bash
# 특정 pane의 출력을 파일로 실시간 기록 시작
tmux pipe-pane -t agent-team:lead "cat >> ~/logs/lead.log"
tmux pipe-pane -t agent-team:agent-1 "cat >> ~/logs/agent-1.log"
tmux pipe-pane -t agent-team:agent-2 "cat >> ~/logs/agent-2.log"

# 로깅 중지 (빈 명령으로 호출)
tmux pipe-pane -t agent-team:lead
```

### 모든 에이전트에 로깅 일괄 적용

```bash
#!/bin/bash
# start-logging.sh - 모든 윈도우에 로깅 시작
SESSION="${1:-agent-team}"
LOG_DIR="logs/$(date +%Y%m%d_%H%M%S)"
mkdir -p "$LOG_DIR"

for window in $(tmux list-windows -t $SESSION -F '#W'); do
  tmux pipe-pane -t "$SESSION:$window" \
    "cat >> $LOG_DIR/${window}.log"
done

echo "로깅 시작: $LOG_DIR"
echo "중지: ./stop-logging.sh $SESSION"
```

```bash
#!/bin/bash
# stop-logging.sh - 로깅 중지
SESSION="${1:-agent-team}"

for window in $(tmux list-windows -t $SESSION -F '#W'); do
  tmux pipe-pane -t "$SESSION:$window"
done

echo "로깅 중지 완료"
```

> **Tip: 에이전트 출력 로그 습관**
> 중요한 Agent Team 작업을 시작하기 전에 `pipe-pane`을 설정하여
> 모든 에이전트의 출력을 로그로 남기세요. 나중에 에이전트가 어떤 판단을
> 내렸는지, 어떤 파일을 수정했는지 추적하는 데 매우 유용합니다.

---

## 5.4 리소스 관리

### CPU/메모리 모니터링

Agent Team은 여러 프로세스를 동시에 실행하므로 시스템 리소스를 주시해야 합니다.

```bash
# 모니터링 pane에서 실행
htop

# 또는 간단한 리소스 모니터
watch -n 3 'echo "=== CPU ===" && \
  top -bn1 | head -5 && \
  echo "" && \
  echo "=== Memory ===" && \
  free -h && \
  echo "" && \
  echo "=== Node.js Processes ===" && \
  ps aux | grep node | grep -v grep | awk "{printf \"PID:%s CPU:%s MEM:%s\n\", \$2, \$3, \$4}"'
```

### 에이전트 수 조절 가이드

| 시스템 메모리 | 권장 에이전트 수 | 비고 |
|-------------|----------------|------|
| 4GB 이하 | 1-2개 | 모니터링 pane 최소화 |
| 8GB | 2-3개 | 일반적인 개발 환경 |
| 16GB | 3-5개 | 권장 설정 |
| 32GB 이상 | 5-7개 | 대규모 프로젝트 |

### API 비용 관리

```bash
# Claude Code 사용량 확인
claude usage

# 비용 모니터링을 위한 체크 습관:
# 1. 작업 시작 전 사용량 확인
# 2. 대규모 작업은 소규모 테스트 후 진행
# 3. 불필요한 에이전트는 줄이기
# 4. 작업 완료 후 사용량 재확인
```

> **Tip: API 비용 관리**
> Agent Team은 여러 에이전트가 동시에 API를 호출하므로,
> 단일 에이전트 대비 비용이 비례적으로 증가합니다.
> 작업 전에 예상 비용을 가늠하고, 불필요한 에이전트는 줄이세요.

---

## 5.5 자주 발생하는 문제 및 해결법

### 문제 1: 에이전트가 멈춘 것처럼 보일 때

```
원인:
  - API 응답 대기 중 (정상)
  - API 속도 제한(rate limit)에 걸림
  - 대용량 파일 처리 중

해결:
  1. 잠시 기다려봅니다 (1-2분)
  2. Ctrl-C로 현재 작업 중단 후 재시도
  3. 더 작은 범위의 작업으로 나누어 재요청
```

```bash
# 에이전트가 실행 중인지 확인
# 해당 pane으로 이동 후:
# 커서가 깜빡이고 있으면 -> API 응답 대기 중 (정상)
# 프롬프트가 나타나면 -> 작업 완료 또는 에러 발생

# 프로세스 확인
ps aux | grep claude
```

### 문제 2: tmux 세션이 예기치 않게 종료될 때

```
원인:
  - 시스템 메모리 부족으로 OOM Killer 작동
  - 시스템 재부팅
  - tmux 서버 크래시

예방:
  1. 충분한 스왑 공간 설정
  2. tmux-resurrect 플러그인으로 세션 자동 저장
  3. 중요 작업 전 pipe-pane으로 로그 기록
```

```bash
# tmux-resurrect 설치 (세션 저장/복원)
git clone https://github.com/tmux-plugins/tmux-resurrect \
  ~/.tmux/plugins/tmux-resurrect

# ~/.tmux.conf에 추가
# run-shell ~/.tmux/plugins/tmux-resurrect/resurrect.tmux

# 세션 저장: Ctrl-b Ctrl-s
# 세션 복원: Ctrl-b Ctrl-r

# 스왑 공간 확인 및 추가
free -h
sudo fallocate -l 4G /swapfile
sudo chmod 600 /swapfile
sudo mkswap /swapfile
sudo swapon /swapfile
```

### 문제 3: 여러 에이전트가 같은 파일을 수정할 때

```
원인:
  - 작업 범위가 명확히 분리되지 않음
  - 공유 파일(설정, 라우터, 인덱스)을 여러 에이전트가 수정

해결:
  1. git status로 충돌 확인
  2. 충돌 파일 수동 해결
  3. 프롬프트에서 파일 범위를 더 명확히 지정
```

```bash
# 충돌 확인
git status

# 충돌 해결 후 에이전트에게 수정 사실 알리기
# Team Lead 프롬프트에서:
# "src/routes/index.ts 파일에 충돌이 있어 수동으로 해결했어.
#  이 파일은 더 이상 수정하지 말고, 새 파일만 추가해줘."
```

### 문제 4: API 속도 제한(rate limit)에 걸릴 때

```
원인:
  - 여러 에이전트가 동시에 API를 호출하여 분당 한도 초과

해결:
  1. 에이전트 수를 줄입니다
  2. 작업을 순차적으로 진행합니다
  3. 잠시 기다린 후 재시도합니다
```

```bash
# 에이전트가 rate limit에 걸린 경우
# 해당 에이전트 pane에서 다음 메시지가 표시됨:
# "Rate limit exceeded. Retrying in X seconds..."

# 대응 방법:
# 1. 해당 에이전트가 자동 재시도하도록 기다림
# 2. 동시 실행 에이전트 수를 줄임
# 3. 작업을 Phase로 나누어 순차 실행
```

### 문제 5: 에이전트 출력이 너무 길어 화면이 넘칠 때

```bash
# 스크롤백 버퍼 크기 늘리기 (~/.tmux.conf)
set-option -g history-limit 50000

# 현재 세션에서 즉시 적용
tmux set-option history-limit 50000

# pane 확대로 전체 출력 확인
# Ctrl-b z (토글)

# 스크롤 모드로 이전 출력 확인
# Ctrl-b [
# Page Up/Down으로 스크롤
# q로 스크롤 모드 종료

# 출력을 파일로 캡처하여 에디터에서 확인
tmux capture-pane -t agent-team:agent-1 -p -S - > output.log
less output.log
```

### 문제 6: 에이전트 간 컨텍스트 불일치

```
원인:
  - 에이전트 A가 수정한 파일을 에이전트 B가 이전 버전으로 덮어쓰기
  - 서로 다른 가정 하에 코드를 작성

예방:
  1. 프롬프트에서 공유 파일과 독점 파일을 명확히 구분
  2. 순서가 중요한 작업은 Phase를 나누어 순차 실행
  3. 각 에이전트의 작업 범위를 디렉토리 단위로 분리

해결:
  1. git diff로 각 에이전트의 변경사항 확인
  2. 충돌 파일을 수동으로 병합
  3. Team Lead에게 통합 요청
```

---

## 5.6 베스트 프랙티스 정리

### Agent Team 운영 체크리스트

```
환경 준비:
  [x] CLAUDE.md 파일 작성 (프로젝트 컨텍스트)
  [x] tmux 세션 생성 및 레이아웃 구성
  [x] 모니터링 pane/윈도우 설정
  [x] 작업 브랜치 생성 (git checkout -b feature/xxx)

프롬프트 작성:
  [x] 전체 목표를 명확히 기술
  [x] 에이전트별 역할과 작업 범위 지정
  [x] 수정할 파일/디렉토리 범위 명시
  [x] 제약 조건 (코딩 스타일, 금지 사항) 명시
  [x] 작업 의존성과 순서 지정 (필요 시)

실행 중:
  [x] 각 에이전트의 진행 상황 정기적으로 확인
  [x] git status로 파일 충돌 모니터링
  [x] 시스템 리소스 확인 (CPU, 메모리)
  [x] pipe-pane으로 로그 기록 (중요 작업)

완료 후:
  [x] 전체 테스트 실행 및 통과 확인
  [x] git diff로 변경사항 검토
  [x] 커밋 및 PR 생성
  [x] 로그 저장 (capture-pane)
  [x] tmux 세션 정리
```

### 효과적인 프롬프트 패턴

| 패턴 | 설명 | 예시 |
|------|------|------|
| **역할 명시** | 각 에이전트의 역할을 구체적으로 | "에이전트 1 (백엔드 코더):" |
| **범위 제한** | 수정 가능한 파일 경로 제한 | "파일 범위: src/server/ 내 파일만" |
| **Phase 구분** | 의존성 있는 작업은 단계별로 | "Phase 1 완료 후 Phase 2 시작" |
| **금지 사항** | 하지 말아야 할 것 명시 | "any 타입 사용 금지" |
| **검증 조건** | 완료 기준을 측정 가능하게 | "npm test 전체 통과" |

### tmux 설정 권장사항

```bash
# ~/.tmux.conf - Agent Team 최적화 설정

# 스크롤백 버퍼 확대
set-option -g history-limit 30000

# 마우스 지원 (pane 크기 조절, 선택)
set -g mouse on

# 상태바 갱신 간격
set -g status-interval 5

# 활동 모니터링
set-window-option -g monitor-activity on
set-option -g visual-activity on

# pane 번호 표시 시간 늘리기
set -g display-panes-time 3000

# 윈도우/pane 인덱스를 1부터 시작
set -g base-index 1
setw -g pane-base-index 1

# 윈도우 이름 자동 변경 비활성화
set-option -g allow-rename off
```

### 프로젝트 유형별 권장 워크플로우

```
웹 프로젝트:
  세션 1개 + 윈도우 5개
  lead / frontend / backend / testing / monitor
  에이전트: 3개 (프론트, 백엔드, 테스트)

라이브러리/패키지:
  세션 1개 + 윈도우 3개
  lead / code / testing
  에이전트: 2개 (코더, 테스터)

마이크로서비스:
  세션 N개 (서비스별)
  각 세션: lead / code / testing / monitor
  에이전트: 서비스당 2-3개

문서화 프로젝트:
  세션 1개 + 윈도우 3개
  lead / docs / review
  에이전트: 2-3개 (분석, 문서화, 검증)
```

> **Tip: tmux 세션 보호**
> 장시간 실행되는 Agent Team 작업의 경우,
> `tmux set-option -g destroy-unattached off`로 설정하여
> 모든 클라이언트가 분리되어도 세션이 유지되도록 하세요.
> 또한 시스템 재부팅에 대비하여 tmux-resurrect 플러그인 사용을 고려하세요.

> **Tip: 자동 구성 스크립트를 프로젝트에 포함시키기**
> `scripts/agent-team-setup.sh` 파일을 프로젝트 저장소에 포함시키면,
> 팀원 누구나 동일한 Agent Team 환경을 빠르게 구성할 수 있습니다.
> README에 사용법을 문서화해 두세요.

---

## 트러블슈팅 흐름도

문제가 발생했을 때 다음 흐름도를 참고하세요:

<div style={{ margin: '20px 0', maxWidth: '700px' }}>
  <div style={{ padding: '12px 20px', background: '#ffebee', border: '2px solid #d32f2f', borderRadius: '8px', fontWeight: 'bold', color: '#d32f2f', textAlign: 'center', marginBottom: '12px' }}>
    에이전트에 문제 발생
  </div>
  <div style={{ display: 'flex', flexDirection: 'column', gap: '8px' }}>
    <div style={{ border: '2px solid #ff9800', borderRadius: '8px', overflow: 'hidden' }}>
      <div style={{ padding: '8px 16px', background: '#ff9800', color: 'white', fontWeight: 'bold', fontSize: '14px' }}>에이전트가 응답하지 않음?</div>
      <div style={{ padding: '10px 16px', background: '#fff3e0', fontSize: '13px' }}>
        <div style={{ marginBottom: '4px' }}>1-2분 기다려봄 → 재개되면 정상 (API 대기)</div>
        <div style={{ marginBottom: '4px' }}>계속 멈춤 → <code>Ctrl-C</code>로 중단 후 재시도</div>
        <div>"Rate limit" 메시지 → 에이전트 수 줄이고 대기</div>
      </div>
    </div>
    <div style={{ border: '2px solid #ff9800', borderRadius: '8px', overflow: 'hidden' }}>
      <div style={{ padding: '8px 16px', background: '#ff9800', color: 'white', fontWeight: 'bold', fontSize: '14px' }}>파일 충돌 발생?</div>
      <div style={{ padding: '10px 16px', background: '#fff3e0', fontSize: '13px' }}>
        <div style={{ marginBottom: '4px' }}><code>git status</code>로 충돌 파일 확인</div>
        <div style={{ marginBottom: '4px' }}>충돌 수동 해결 (에디터에서)</div>
        <div>Team Lead에게 수정 사실 알리고 재시도</div>
      </div>
    </div>
    <div style={{ border: '2px solid #ff9800', borderRadius: '8px', overflow: 'hidden' }}>
      <div style={{ padding: '8px 16px', background: '#ff9800', color: 'white', fontWeight: 'bold', fontSize: '14px' }}>시스템 리소스 부족?</div>
      <div style={{ padding: '10px 16px', background: '#fff3e0', fontSize: '13px' }}>
        <div style={{ marginBottom: '4px' }}><code>htop</code>으로 CPU/메모리 확인</div>
        <div style={{ marginBottom: '4px' }}>불필요한 에이전트 종료</div>
        <div>에이전트 수 줄여서 재시작</div>
      </div>
    </div>
    <div style={{ border: '2px solid #ff9800', borderRadius: '8px', overflow: 'hidden' }}>
      <div style={{ padding: '8px 16px', background: '#ff9800', color: 'white', fontWeight: 'bold', fontSize: '14px' }}>에이전트가 잘못된 코드를 작성?</div>
      <div style={{ padding: '10px 16px', background: '#fff3e0', fontSize: '13px' }}>
        <div style={{ marginBottom: '4px' }}><code>git diff</code>로 변경사항 확인</div>
        <div style={{ marginBottom: '4px' }}><code>git checkout -- [파일]</code>로 변경 취소</div>
        <div>더 구체적인 프롬프트로 재시도</div>
      </div>
    </div>
    <div style={{ border: '2px solid #ff9800', borderRadius: '8px', overflow: 'hidden' }}>
      <div style={{ padding: '8px 16px', background: '#ff9800', color: 'white', fontWeight: 'bold', fontSize: '14px' }}>tmux 세션이 사라짐?</div>
      <div style={{ padding: '10px 16px', background: '#fff3e0', fontSize: '13px' }}>
        <div style={{ marginBottom: '4px' }}><code>tmux ls</code>로 세션 목록 확인</div>
        <div style={{ marginBottom: '4px' }}>세션 있으면 → <code>tmux attach -t [이름]</code></div>
        <div>세션 없으면 → 스크립트로 재구성 (pipe-pane 로그로 진행 상황 확인)</div>
      </div>
    </div>
  </div>
</div>

다음 장에서는 빠른 참조 카드를 제공합니다.
